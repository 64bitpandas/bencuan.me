import{j as i}from"./jsx-runtime.mLGpN2ti.js";import{r as s,R as S}from"./index.B1tThdBL.js";const q=({start:t,end:n,color:r="#000000",content:p=""})=>{const[u,h]=s.useState(t),[w,f]=s.useState(n),[x,b]=s.useState(0),[l,m]=s.useState(0);return s.useEffect(()=>{const y=window.innerWidth,g=window.innerHeight;m(Math.atan2(n.y-t.y,n.x-t.x)),b(Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2)));let a={...t},d={...n};Math.abs(Math.cos(l))>Math.abs(Math.sin(l))?(a.x=t.x<n.x?0:y,a.y=t.y+Math.tan(l)*(a.x-t.x),d.x=t.x<n.x?y:0,d.y=t.y+Math.tan(l)*(d.x-t.x)):(a.y=t.y<n.y?0:g,a.x=t.x+(a.y-t.y)/Math.tan(l),d.y=t.y<n.y?g:0,d.x=t.x+(d.y-t.y)/Math.tan(l)),h(a),f(d)},[t,n]),i.jsxs("div",{style:{position:"fixed",left:"50%",top:"50%",transform:`translate(-50%, -50%) translate(${x*Math.cos(l)}px, ${x*Math.sin(l)}px)`,display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",zIndex:1e3},children:[i.jsx("div",{style:{background:r,color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"nowrap",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",transform:`rotate(${l}rad)`},children:p}),i.jsx("div",{style:{width:"20px",height:"20px",background:r,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",transform:`rotate(${l}rad)`},children:i.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"white",children:i.jsx("path",{d:"M12 19V5M5 12l7-7 7 7",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})},A=({position:t,label:n,viewPosition:r,onClick:p})=>{const u={x:-r.x-t.x,y:-r.y-t.y},h=Math.atan2(-u.y,-u.x),w=Math.min(Math.sqrt(u.x**2+u.y**2)/4,100),f={position:"fixed",left:"50%",top:"50%",width:"40px",height:"40px",transform:`translate(-50%, -50%) translate(${w*Math.cos(h)}px, ${w*Math.sin(h)}px) rotate(${h}rad)`,cursor:p?"pointer":"default",transition:"transform 0.2s ease-out",zIndex:1e3,background:"rgba(255, 255, 255, 0.8)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"};return i.jsxs("div",{style:f,onClick:p,children:[i.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:i.jsx("path",{d:"M12 19V5M5 12l7-7 7 7",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),i.jsx("div",{style:{position:"absolute",bottom:"-20px",left:"50%",transform:`translateX(-50%) rotate(-${h}rad)`,whiteSpace:"nowrap",fontSize:"12px",background:"rgba(0, 0, 0, 0.7)",color:"white",padding:"2px 6px",borderRadius:"4px"},children:n})]})},D=({position:t})=>i.jsxs("div",{style:{position:"fixed",left:"20px",bottom:"20px",padding:"8px 12px",background:"rgba(0, 0, 0, 0.7)",color:"white",borderRadius:"4px",fontFamily:"monospace",fontSize:"14px",zIndex:1e3,userSelect:"none"},children:["x: ",Math.round(t.x),", y: ",Math.round(t.y)]}),z=({children:t,moveSpeed:n=5})=>{const[r,p]=s.useState({x:0,y:0}),[u,h]=s.useState(!1),[w,f]=s.useState({x:0,y:0}),[x,b]=s.useState(!1),l=s.useRef(null),m=s.useRef({}),y=s.useRef(),g=e=>{if(x)return;h(!0);const o="touches"in e?e.touches[0].clientX:e.clientX,c="touches"in e?e.touches[0].clientY:e.clientY;f({x:o-r.x,y:c-r.y})},a=s.useCallback(e=>{if(!u||x)return;const o="touches"in e?e.touches[0].clientX:e.clientX,c="touches"in e?e.touches[0].clientY:e.clientY;p({x:o-w.x,y:c-w.y})},[u,w,x]),d=()=>{h(!1)},M=s.useCallback(e=>{x||(m.current[e.key.toLowerCase()]=!0)},[x]),k=s.useCallback(e=>{m.current[e.key.toLowerCase()]=!1},[]),j=s.useCallback(e=>{b(!0);const o={...r},c=performance.now(),v=1e3,L=I=>{const F=I-c,C=Math.min(F/v,1),P=1-Math.pow(1-C,3);p({x:o.x+(e.x-o.x)*P,y:o.y+(e.y-o.y)*P}),C<1?requestAnimationFrame(L):b(!1)};requestAnimationFrame(L)},[r]),R=s.useCallback(()=>{j({x:0,y:0})},[j]),E=s.useCallback(()=>{if(x)return;const e=m.current;let o=0,c=0;(e.w||e.arrowup)&&(c+=n),(e.s||e.arrowdown)&&(c-=n),(e.a||e.arrowleft)&&(o+=n),(e.d||e.arrowright)&&(o-=n),(o!==0||c!==0)&&p(v=>({x:v.x+o,y:v.y+c})),y.current=requestAnimationFrame(E)},[n,x]);s.useEffect(()=>(window.addEventListener("mousemove",a),window.addEventListener("mouseup",d),window.addEventListener("touchmove",a),window.addEventListener("touchend",d),window.addEventListener("keydown",M),window.addEventListener("keyup",k),y.current=requestAnimationFrame(E),()=>{window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",d),window.removeEventListener("touchmove",a),window.removeEventListener("touchend",d),window.removeEventListener("keydown",M),window.removeEventListener("keyup",k),y.current&&cancelAnimationFrame(y.current)}),[a,M,k,E]);const $=S.Children.map(t,e=>{if(S.isValidElement(e)&&"position"in e.props){const o=e.props.position,c=e.props.label||`(${o.x}, ${o.y})`;return i.jsxs(i.Fragment,{children:[i.jsx(A,{position:o,label:c,viewPosition:r,onClick:()=>j({x:-o.x,y:-o.y})}),S.cloneElement(e,{label:c})]})}return e});return i.jsxs("div",{ref:l,style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",cursor:u?"grabbing":"grab",userSelect:"none",touchAction:"none"},onMouseDown:g,onTouchStart:g,tabIndex:0,children:[i.jsx("div",{style:{transform:`translate(${r.x}px, ${r.y}px)`,position:"absolute",transition:u||x?"none":"transform 0.1s ease-out"},children:$}),i.jsx(A,{position:{x:0,y:0},label:"Origin",viewPosition:r,onClick:R}),i.jsx(D,{position:r})]})};export{q as ElementArrow,z as default};
